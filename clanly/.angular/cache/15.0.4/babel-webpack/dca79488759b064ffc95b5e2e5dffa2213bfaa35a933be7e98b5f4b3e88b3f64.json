{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input } from '@angular/core';\nimport { FormGroup, FormControl } from '@angular/forms';\nlet BigformComponent = class BigformComponent {\n  constructor(api, auth, router, ro) {\n    this.api = api;\n    this.auth = auth;\n    this.router = router;\n    this.ro = ro;\n    this.editForm = new FormGroup({\n      name: new FormControl(),\n      desc: new FormControl(),\n      password: new FormControl(),\n      password2: new FormControl(),\n      password3: new FormControl()\n    });\n  }\n  ngOnInit() {\n    if (this.type === \"user\") {\n      this.api.getBasicProfile().subscribe(data => {\n        this.editForm.controls.name.setValue(data.name);\n        this.editForm.controls.desc.setValue(data.bio);\n      });\n    } else if (this.type === \"edit-clan\") {\n      this.api.getBasicClan().subscribe(data => {\n        this.editForm.controls.name.setValue(data.name);\n        this.editForm.controls.desc.setValue(data.desc);\n      });\n    }\n  }\n  onImgChange(event) {\n    this.img = event.target.files[0];\n  }\n  onBackgroundImgChange(event) {\n    this.background_img = event.target.files[0];\n  }\n  onSubmit() {\n    if (this.type === \"user\") {\n      if (!this.editForm.value.password) {\n        alert(\"Please enter your password\");\n      } else if ((this.editForm.value.password2 || this.editForm.value.password3) && this.editForm.value.password2 !== this.editForm.value.password3) {\n        alert(\"Passwords do not match\");\n      } else {\n        let header = {\n          name: this.editForm.value.name,\n          bio: this.editForm.value.desc,\n          password: this.editForm.value.password\n        };\n        if (this.editForm.value.password2) {\n          header.new_password = this.editForm.value.password2;\n        }\n        if (this.img) {\n          let reader = new FileReader();\n          reader.readAsDataURL(this.img);\n          reader.onload = () => {\n            header.img = [reader.result, this.img.name];\n            if (this.background_img) {\n              let reader2 = new FileReader();\n              reader2.readAsDataURL(this.background_img);\n              reader2.onload = () => {\n                header.background_img = [reader2.result, this.background_img.name];\n                this.api_call(header);\n              };\n            } else {\n              this.api_call(header);\n            }\n          };\n        } else if (this.background_img) {\n          let reader = new FileReader();\n          reader.readAsDataURL(this.background_img);\n          reader.onload = () => {\n            header.background_img = [reader.result, this.background_img.name];\n            if (this.img) {\n              let reader2 = new FileReader();\n              reader2.readAsDataURL(this.img);\n              reader2.onload = () => {\n                header.img = [reader2.result, this.img.name];\n                this.api_call(header);\n              };\n            } else {\n              this.api_call(header);\n            }\n          };\n        } else {\n          this.api_call(header);\n        }\n      }\n    } else if (this.type === \"clan\") {\n      let header = {\n        name: this.editForm.value.name,\n        desc: this.editForm.value.desc,\n        password: this.editForm.value.password\n      };\n      if (this.img) {\n        let reader = new FileReader();\n        reader.readAsDataURL(this.img);\n        reader.onload = () => {\n          header.img = [reader.result, this.img.name];\n          if (this.background_img) {\n            let reader2 = new FileReader();\n            reader2.readAsDataURL(this.background_img);\n            reader2.onload = () => {\n              header.background_img = [reader2.result, this.background_img.name];\n              this.api_call(header);\n            };\n          } else {\n            this.api_call(header);\n          }\n        };\n      } else if (this.background_img) {\n        let reader = new FileReader();\n        reader.readAsDataURL(this.background_img);\n        reader.onload = () => {\n          header.background_img = [reader.result, this.background_img.name];\n          if (this.img) {\n            let reader2 = new FileReader();\n            reader2.readAsDataURL(this.img);\n            reader2.onload = () => {\n              header.img = [reader2.result, this.img.name];\n              this.api_call(header);\n            };\n          } else {\n            this.api_call(header);\n          }\n        };\n      } else {\n        this.api_call(header);\n      }\n    } else if (this.type === \"edit-clan\") {}\n  }\n  api_call(header) {\n    if (this.type === \"user\") {\n      this.api.updateProfile(header).subscribe(data => {\n        if (data.hasOwnProperty('error')) {\n          alert(data.error);\n        } else {\n          alert(data.success);\n          if (this.editForm.value.password2) {\n            this.auth.logout();\n            return;\n          }\n          window.location.reload();\n        }\n      });\n    } else if (this.type === \"clan\") {\n      this.api.createClan(header).subscribe(data => {\n        if (data.hasOwnProperty('error')) {\n          alert(data.error);\n        } else {\n          alert(data.success);\n          this.router.navigate(['/myclans']);\n        }\n      });\n    }\n  }\n};\n__decorate([Input()], BigformComponent.prototype, \"type\", void 0);\nBigformComponent = __decorate([Component({\n  selector: 'app-bigform',\n  templateUrl: './bigform.component.html',\n  styleUrls: ['./bigform.component.css']\n})], BigformComponent);\nexport { BigformComponent };","map":{"version":3,"mappings":"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","names":["Component","Input","FormGroup","FormControl","BigformComponent","constructor","api","auth","router","ro","editForm","name","desc","password","password2","password3","ngOnInit","type","getBasicProfile","subscribe","data","controls","setValue","bio","getBasicClan","onImgChange","event","img","target","files","onBackgroundImgChange","background_img","onSubmit","value","alert","header","new_password","reader","FileReader","readAsDataURL","onload","result","reader2","api_call","updateProfile","hasOwnProperty","error","success","logout","window","location","reload","createClan","navigate","__decorate","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/home/gui/TPW/tpw-projeto2/clanly/src/app/components/bigform/bigform.component.ts"],"sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\nimport { FormGroup, FormControl } from '@angular/forms';\nimport { ApiService } from 'src/app/services/api-service.service';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-bigform',\n  templateUrl: './bigform.component.html',\n  styleUrls: ['./bigform.component.css']\n})\nexport class BigformComponent implements OnInit {\n  @Input() type?: string;\n  editForm: FormGroup | any;\n  img: File | any;\n  background_img: File | any;\n\n  constructor(private api: ApiService, private auth: AuthService, private router: Router, private ro) {\n    this.editForm = new FormGroup({\n      name: new FormControl(),\n      desc: new FormControl(),\n      password: new FormControl(),\n      password2: new FormControl(),\n      password3: new FormControl(),\n    });\n  }\n\n  ngOnInit(): void {\n    \n    if (this.type === \"user\") {\n      this.api.getBasicProfile().subscribe((data: any) => {\n        this.editForm.controls.name.setValue(data.name);\n        this.editForm.controls.desc.setValue(data.bio);\n      });\n    } else if (this.type === \"edit-clan\") {\n      this.api.getBasicClan().subscribe((data: any) => {\n        this.editForm.controls.name.setValue(data.name);\n        this.editForm.controls.desc.setValue(data.desc);\n      });\n    }\n  }\n\n  onImgChange(event: any) {\n    this.img = event.target.files[0];\n  }\n\n  onBackgroundImgChange(event: any) {\n    this.background_img = event.target.files[0];\n  }\n\n  onSubmit() {\n    if (this.type === \"user\") {\n      if (!this.editForm.value.password) {\n        alert(\"Please enter your password\");\n      }\n      else if ((this.editForm.value.password2 || this.editForm.value.password3) && this.editForm.value.password2 !== this.editForm.value.password3) {\n        alert(\"Passwords do not match\");\n      }\n      else {\n        let header: {name: string, bio: string, password: string, new_password?: string, img?:any, background_img?:any, token?: any} = {\n          name: this.editForm.value.name,\n          bio: this.editForm.value.desc,\n          password: this.editForm.value.password,\n        };\n        if (this.editForm.value.password2) {\n          header.new_password = this.editForm.value.password2;\n        }\n        if (this.img) {\n          let reader = new FileReader();\n          reader.readAsDataURL(this.img);\n          reader.onload = () => {\n            header.img = [reader.result as string, this.img.name];\n            if (this.background_img) {\n              let reader2 = new FileReader();\n              reader2.readAsDataURL(this.background_img);\n              reader2.onload = () => {\n                header.background_img = [reader2.result as string, this.background_img.name];\n                this.api_call(header);\n              }\n            }\n            else {\n              this.api_call(header);\n            }\n          }\n        }\n        else if (this.background_img) {\n          let reader = new FileReader();\n          reader.readAsDataURL(this.background_img);\n          reader.onload = () => {\n            header.background_img = [reader.result as string, this.background_img.name];\n            if (this.img) {\n              let reader2 = new FileReader();\n              reader2.readAsDataURL(this.img);\n              reader2.onload = () => {\n                header.img = [reader2.result as string, this.img.name];\n                this.api_call(header);\n              }\n            }\n            else {\n              this.api_call(header);\n            }\n          }\n        }\n        else {\n          this.api_call(header);\n        }\n      }\n    } else if (this.type === \"clan\") {\n      let header: { name: string, desc: string, password: string, img?:any, background_img?:any, token?: any } = {\n        name: this.editForm.value.name,\n        desc: this.editForm.value.desc,\n        password: this.editForm.value.password,\n      };\n      if (this.img) {\n        let reader = new FileReader();\n        reader.readAsDataURL(this.img);\n        reader.onload = () => {\n          header.img = [reader.result as string, this.img.name];\n          if (this.background_img) {\n            let reader2 = new FileReader();\n            reader2.readAsDataURL(this.background_img);\n            reader2.onload = () => {\n              header.background_img = [reader2.result as string, this.background_img.name];\n              this.api_call(header);\n            }\n          }\n          else {\n            this.api_call(header);\n          }\n        }\n      }\n      else if (this.background_img) {\n        let reader = new FileReader();\n        reader.readAsDataURL(this.background_img);\n        reader.onload = () => {\n          header.background_img = [reader.result as string, this.background_img.name];\n          if (this.img) {\n            let reader2 = new FileReader();\n            reader2.readAsDataURL(this.img);\n            reader2.onload = () => {\n              header.img = [reader2.result as string, this.img.name];\n              this.api_call(header);\n            }\n          }\n          else {\n            this.api_call(header);\n          }\n        }\n      } else {\n        this.api_call(header);\n      }\n    } else if (this.type === \"edit-clan\") {\n    }\n  }\n\n  api_call(header: any) {\n    if (this.type === \"user\") {\n      this.api.updateProfile(header).subscribe((data: any) => {\n        if (data.hasOwnProperty('error')) {\n          alert(data.error);\n        }\n        else {\n          alert(data.success);\n          if (this.editForm.value.password2) {\n            this.auth.logout();\n            return;\n          }\n          window.location.reload();\n        }\n      });\n    } else if (this.type === \"clan\") {\n      this.api.createClan(header).subscribe((data: any) => {\n        if (data.hasOwnProperty('error')) {\n          alert(data.error);\n        }\n        else {\n          alert(data.success);\n          this.router.navigate(['/myclans']);\n        }\n      });\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}